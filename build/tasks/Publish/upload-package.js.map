{"version":3,"sources":["../../../src/tasks/Publish/upload-package.js"],"names":["uploadPackage","pkg","pkgPath","registry","pkgTempDir","pkgTempDirPkg","join","gitpkgPackageName","e","console","warn"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;;;kBAEe,eAAeA,aAAf,CAA6BC,GAA7B,EAAkCC,OAAlC,EAA2CC,QAA3C,EAAqD;AAClE,QAAMC,aAAa,MAAM,0BAAWH,GAAX,CAAzB;AACA,QAAMI,gBAAgB,eAAKC,IAAL,CAAUF,UAAV,EAAsB,SAAtB,CAAtB;AACA,QAAMG,oBAAoB,6BAAcN,GAAd,CAA1B;AACA,QAAM,6BAAc,UAAd,EAA0BI,aAA1B,CAAN;AACA,QAAM,6BAAc,WAAd,EAA2BA,aAA3B,CAAN;AACA,QAAM,6BAAc,sBAAd,EAAsCA,aAAtC,CAAN;AACA,QAAM,6BAAe,yBAAwBF,QAAS,EAAhD,EAAmDE,aAAnD,CAAN;AACA,QAAM,6BAAe,WAAUE,iBAAkB,EAA3C,EAA8CF,aAA9C,CAAN;;AAEA;AACA,MAAI;AACF,UAAM,6BACH,4BAA2BE,iBAAkB,EAD1C,EAEJF,aAFI,CAAN;AAID,GALD,CAKE,OAAOG,CAAP,EAAU;AACVC,YAAQC,IAAR,CAAaF,CAAb;AACD;AACD,QAAM,6BAAe,mBAAkBD,iBAAkB,EAAnD,EAAsDF,aAAtD,CAAN;AACD,C","file":"upload-package.js","sourcesContent":["import path from \"path\";\nimport execLikeShell from \"./exec-like-shell\";\nimport getTempDir from \"./get-temp-dir\";\nimport getGitTagName from \"./get-git-tag-name\";\n\nexport default async function uploadPackage(pkg, pkgPath, registry) {\n  const pkgTempDir = await getTempDir(pkg);\n  const pkgTempDirPkg = path.join(pkgTempDir, \"package\");\n  const gitpkgPackageName = getGitTagName(pkg);\n  await execLikeShell(\"git init\", pkgTempDirPkg);\n  await execLikeShell(\"git add .\", pkgTempDirPkg);\n  await execLikeShell(\"git commit -m gitpkg\", pkgTempDirPkg);\n  await execLikeShell(`git remote add origin ${registry}`, pkgTempDirPkg);\n  await execLikeShell(`git tag ${gitpkgPackageName}`, pkgTempDirPkg);\n\n  // change Relive; first delete the tag\n  try {\n    await execLikeShell(\n      `git push --delete origin ${gitpkgPackageName}`,\n      pkgTempDirPkg\n    );\n  } catch (e) {\n    console.warn(e);\n  }\n  await execLikeShell(`git push origin ${gitpkgPackageName}`, pkgTempDirPkg);\n}\n"]}